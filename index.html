<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Learning Journal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Load Inter font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Helper component to render content based on type
        const ContentRenderer = ({ contentItem }) => {
            const { type, text } = contentItem;

            switch (type) {
                // Major Section Headings (1, 2, 3...)
                case 'h2':
                    return <h3 className="text-2xl font-extrabold text-gray-800 pt-6 mb-3 border-t-2 border-indigo-500 mt-6">{text}</h3>;
                // Step Headings (Step 1, Step 2...)
                case 'h3':
                    return <h4 className="text-xl font-bold text-indigo-700 mt-4 mb-2">{text}</h4>;
                
                // Highlighted HTTP Request Line (Green Banner)
                case 'request':
                    return (
                        <div className="p-3 my-3 bg-green-50 border-l-4 border-green-400 text-green-800 font-mono text-sm overflow-x-auto rounded-r-lg shadow-sm">
                            **HTTP Request:** {text}
                        </div>
                    );
                // Highlighted HTTP Response Line (Red Banner)
                case 'response':
                    return (
                        <div className="p-3 my-3 bg-red-50 border-l-4 border-red-400 text-red-800 font-mono text-sm overflow-x-auto rounded-r-lg shadow-sm">
                            **HTTP Response:** {text}
                        </div>
                    );
                
                // Code Blocks (for Python dictionaries, etc.)
                case 'code_block':
                    return (
                        <pre className="p-3 my-3 bg-gray-100 text-gray-800 font-mono text-sm rounded-lg overflow-x-auto whitespace-pre-wrap shadow-inner">
                            <code>{text}</code>
                        </pre>
                    );
                
                // Flow Diagram (Dark Background)
                case 'flow':
                    return (
                        <div className="p-4 my-4 bg-gray-800 text-white font-mono text-sm rounded-lg shadow-xl overflow-x-auto text-center">
                            <span className="inline-block py-1 px-3 bg-indigo-500 rounded-full text-xs font-bold mr-2">FLOW</span>
                            <span className="block mt-2 text-base">{text}</span>
                        </div>
                    );

                // Important Callouts (Red Border)
                case 'important':
                    return (
                        <p className="text-lg font-semibold text-red-700 border-l-4 border-red-400 pl-4 py-2 my-3 bg-red-50 rounded-r-lg">
                            <span className="font-extrabold mr-1">‚ö†Ô∏è Important:</span> {text}
                        </p>
                    );

                // Key Point Callouts (Blue Border)
                case 'key_point':
                case 'key_insight':
                    return (
                        <p className="text-lg italic text-blue-700 border-l-4 border-blue-400 pl-4 py-2 my-3 bg-blue-50 rounded-r-lg">
                            <span className="font-bold mr-1">üí° Key Insight:</span> {text}
                        </p>
                    );

                // Golden Rule Box (Yellow Box)
                case 'golden_rule':
                    return (
                        <div className="text-center p-4 my-4 bg-yellow-100 border-2 border-yellow-400 rounded-lg shadow-md">
                            <p className="text-xl font-extrabold text-yellow-800">
                                üëë Golden Rule:
                            </p>
                            <p className="text-lg text-yellow-800 mt-1 font-medium">
                                {text}
                            </p>
                        </div>
                    );
                
                // List Items (used for TL;DR and Analogy)
                case 'list':
                    return <li className="ml-5 list-disc text-gray-700 leading-relaxed text-lg">{text}</li>;

                // Conclusion
                case 'conclusion':
                    return (
                        <p className="mt-8 pt-4 border-t-2 border-indigo-500 text-xl font-semibold text-gray-800">
                            {text}
                        </p>
                    );

                // Default Paragraphs
                case 'paragraph':
                default:
                    // Using a simple regex to replace **bold** with <strong> for better styling
                    const formattedText = text.split('**').map((segment, i) => 
                        i % 2 === 1 ? <strong key={i} className="text-gray-900">{segment}</strong> : segment
                    );
                    return <p className="text-gray-700 leading-relaxed text-lg">{formattedText}</p>;
            }
        };


        // === Blog Post Data (Updated to structured format) ===
        const postsData = [
            {
                id: 1,
                title: "Understanding Django: HTTP Request Lifecycle",
                date: "November 25, 2025",
                tags: ["Django"],
                content: [
                    { type: 'paragraph', text: "When you build a Django application, understanding how a browser or client request travels through your Django project is crucial. This guide explains the **HTTP request lifecycle**, how Django handles it, and the role of **WSGI**, **views**, and **models**." },
                    
                    { type: 'h2', text: "1Ô∏è‚É£ The HTTP Request Lifecycle in Django" },
                    { type: 'paragraph', text: "Suppose a client (browser or Postman) sends an HTTP request:" },
                    { type: 'request', text: "GET /api/posts/ HTTP/1.1 Host: 127.0.0.1:8000" },
                    { type: 'paragraph', text: "Here‚Äôs what happens step by step:" },

                    { type: 'h3', text: "Step 1: Request arrives at the server" },
                    { type: 'paragraph', text: "The Django development server (started via **`python manage.py runserver`**) or a production server like **Gunicorn/uWSGI** is listening on a TCP port (default is **8000**)." },
                    { type: 'paragraph', text: "The HTTP request travels over **TCP/IP** from the client to your machine, where it is picked up by the **server socket**." },
                    { type: 'important', text: "The server is just a Python process (or a production server process) listening for incoming network requests." },

                    { type: 'h3', text: "Step 2: Server passes request to Django (WSGI)" },
                    { type: 'paragraph', text: "The server calls the **WSGI application** defined in **`wsgi.py`**:" },
                    { type: 'code_block', text: "application = get_wsgi_application()" },
                    { type: 'paragraph', text: "**WSGI (Web Server Gateway Interface)** converts the raw HTTP request into a Python-compatible object called the **`environ` dictionary**:" },
                    { type: 'code_block', text: "{ 'REQUEST_METHOD': 'GET', 'PATH_INFO': '/api/posts/', 'QUERY_STRING': '', ... }" },
                    { type: 'paragraph', text: "Now, the request is in a format that Django can understand and process." },
                    { type: 'key_point', text: "WSGI acts as a bridge between the server process and your Python Django application. Without it, Python wouldn‚Äôt understand HTTP requests." },

                    { type: 'h3', text: "Step 3: Django URL dispatcher routes the request" },
                    { type: 'paragraph', text: "Django inspects the **`urls.py`** files (both project-level and app-level) to determine which view function or class should handle this request. For example: **path('api/posts/', posts_api)**. The request **GET /api/posts/** is routed to the **`posts_api`** view function." },
                    { type: 'important', text: "The URL dispatcher allows you to separate the routing of your project from the actual view logic." },

                    { type: 'h3', text: "Step 4: View handles the HTTP method" },
                    { type: 'paragraph', text: "Inside the view function, the view inspects **`request.method`** to determine whether it is **GET**, **POST**, **PUT**, **DELETE**, etc. It then executes the corresponding logic: fetches data from models, performs business logic, and prepares the response." },
                    { type: 'key_insight', text: "Views are responsible for processing the request and generating the response, but the server and WSGI handle transport and communication." },

                    { type: 'h3', text: "Step 5: Response returned via WSGI" },
                    { type: 'paragraph', text: "The view returns a **`HttpResponse`** or **`JsonResponse`** object. WSGI converts this into raw HTTP bytes ready to send back to the client:" },
                    { type: 'response', text: "HTTP/1.1 200 OK Content-Type: application/json Content-Length: 123 [{\"id\":1,\"title\":\"Hello\"}]" },
                    { type: 'paragraph', text: "The server sends this back over **TCP/IP** ‚Üí the client receives it." },
                    { type: 'important', text: "WSGI acts as the bridge in both directions: incoming requests ‚Üí Python ‚Üí response ‚Üí outgoing HTTP." },

                    { type: 'h2', text: "2Ô∏è‚É£ Key Insight" },
                    { type: 'paragraph', text: "Every **HTTP request** (GET, POST, PUT, DELETE) is first converted into a Python-compatible object (**request**) by **WSGI**. Django routes it to the appropriate **view**, which handles it according to the method. Finally, **WSGI** and the **server** send the response back over the network." },
                    { type: 'important', text: "HTTP requests do not magically go into Django code. They are first received, converted, routed, and then processed." },

                    { type: 'h2', text: "3Ô∏è‚É£ Conceptual Flow (simplified)" },
                    { type: 'flow', text: "Client (Browser/Postman) ‚Üí TCP/IP ‚Üí Server Socket ‚Üí WSGI ‚Üí Python request object ‚Üí Django URL dispatcher ‚Üí View function ‚Üí handle GET/POST/PUT/DELETE ‚Üí fetch models ‚Üí HttpResponse/JsonResponse ‚Üí WSGI ‚Üí TCP/IP ‚Üí client" },

                    { type: 'h2', text: "4Ô∏è‚É£ TL;DR (In Simple Words)" },
                    { type: 'paragraph', text: "The simple steps are:" },
                    { type: 'list', text: "HTTP requests arrive at the **server** (development or production)." },
                    { type: 'list', text: "**WSGI** converts raw HTTP into a Python object that Django understands." },
                    { type: 'list', text: "Django **URL dispatcher** finds the right **view** for this request." },
                    { type: 'list', text: "**View** handles the request logic and prepares a response." },
                    { type: 'list', text: "**WSGI** converts the response into raw HTTP bytes." },
                    { type: 'list', text: "**Server** sends the response back to the client." },
                    { type: 'golden_rule', text: "WSGI is the translator between the network world (HTTP) and the Python world (Django views)." },

                    { type: 'h2', text: "5Ô∏è‚É£ Extra Notes for Beginners" },
                    { type: 'list', text: "Development server (**'runserver'**) is single-threaded and only for testing. Production uses servers like **Gunicorn** or **uWSGI**." },
                    { type: 'list', text: "**WSGI** is a Python standard; all Python web frameworks follow it." },
                    { type: 'list', text: "This lifecycle applies to regular HTML requests as well as **REST API** calls." },
                    { type: 'list', text: "**Models** are only involved if your view fetches or modifies data in the database." },

                    { type: 'h2', text: "6Ô∏è‚É£ Analogy" },
                    { type: 'paragraph', text: "Think of this like a restaurant:" },
                    { type: 'list', text: "1. Client ‚Üí **customer** placing an order" },
                    { type: 'list', text: "2. Server ‚Üí **waiter** receiving the order" },
                    { type: 'list', text: "3. WSGI ‚Üí **translator**: converts order into kitchen instructions" },
                    { type: 'list', text: "4. View ‚Üí **chef** preparing the meal" },
                    { type: 'list', text: "5. Model ‚Üí **ingredients and storage** (database)" },
                    { type: 'list', text: "6. Response ‚Üí **waiter** brings the meal back to the customer" },
                    { type: 'paragraph', text: "Everything flows step by step, and each component has a clear responsibility." },

                    { type: 'conclusion', text: "‚úÖ Conclusion: Understanding this lifecycle helps you debug, optimize, and design Django applications more effectively. It also shows why Django separates responsibilities: server/transport (**WSGI**), routing (**URL dispatcher**), processing (**views**), and data (**models**)." }
                ],
            },
        ];

        // Component to display a single blog post
        const BlogPost = ({ post }) => {
            // Function to manually render <ul> for consecutive list items
            const renderContent = (content) => {
                const elements = [];
                let i = 0;
                while (i < content.length) {
                    const item = content[i];
                    if (item.type === 'list') {
                        // Start a new <ul> for consecutive list items
                        const listItems = [];
                        let j = i;
                        while (j < content.length && content[j].type === 'list') {
                            listItems.push(content[j]);
                            j++;
                        }
                        elements.push(
                            <ul key={i} className="space-y-2 pl-5">
                                {listItems.map((listItem, liIndex) => (
                                    <ContentRenderer key={liIndex} contentItem={listItem} />
                                ))}
                            </ul>
                        );
                        i = j; // Move index past the processed list items
                    } else {
                        // Render non-list item normally
                        elements.push(<ContentRenderer key={i} contentItem={item} />);
                        i++;
                    }
                }
                return elements;
            };

            return (
                <div className="bg-white p-6 md:p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 mb-8 border border-gray-100">
                    <header className="mb-4 border-b pb-3">
                        <h2 className="text-3xl font-extrabold text-gray-900 mb-2 leading-tight">
                            {post.title}
                        </h2>
                        <p className="text-sm text-indigo-600 font-medium">
                            Published on {post.date}
                        </p>
                    </header>

                    {/* Main Content Area - uses the specialized renderer */}
                    <section className="space-y-5 text-gray-700 leading-relaxed text-lg">
                        {renderContent(post.content)}
                    </section>

                    {/* Tags */}
                    <footer className="mt-6 pt-4 border-t border-gray-100 flex flex-wrap gap-2">
                        {post.tags.map((tag, index) => (
                            <span
                                key={index}
                                className="px-3 py-1 text-xs font-semibold text-indigo-700 bg-indigo-100 rounded-full"
                            >
                                #{tag}
                            </span>
                        ))}
                    </footer>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            return (
                <div className="min-h-screen bg-gray-50 font-sans antialiased">
                    
                    {/* Header */}
                    <header className="bg-indigo-700 shadow-lg sticky top-0 z-10">
                        <div className="max-w-4xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
                            <h1 className="text-2xl md:text-3xl font-bold text-white tracking-tight">
                                My Learning Journal
                            </h1>
                            <p className="text-indigo-200 text-sm mt-1">
                                Documenting my journey one concept at a time.
                            </p>
                        </div>
                    </header>

                    {/* Main Content Area (Blog List) */}
                    <main className="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
                        <h2 className="text-4xl font-extrabold text-gray-800 mb-10 border-b-4 border-indigo-500 inline-block pb-1">
                            Latest Concepts
                        </h2>

                        {/* List of Posts */}
                        <div className="divide-y divide-gray-200">
                            {postsData.map((post) => (
                                <BlogPost key={post.id} post={post} />
                            ))}
                        </div>
                        
                        {/* Footer */}
                        <footer className="mt-12 text-center text-gray-500 text-sm py-4 border-t">
                            <p>&copy; 2025 Learning Journal. Built with React and Tailwind CSS.</p>
                        </footer>
                    </main>
                </div>
            );
        };

        // Render the App component
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

    </script>
</body>
</html>